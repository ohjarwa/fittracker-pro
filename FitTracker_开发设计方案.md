# FitTracker Pro — 智能健身训练系统开发设计方案

> **版本**: v1.0 Draft
> **日期**: 2026-02-15
> **状态**: 规划阶段

---

## 一、项目概述

### 1.1 项目定位

面向健身爱好者的智能训练管理系统，核心价值链为：**记录 → 分析 → 规划 → 自适应**。系统从基础训练日志出发，逐步进化为具备 1RM 推算、智能计划生成、生理数据驱动的自适应训练平台。

### 1.2 目标用户

| 用户类型 | 特征 | 核心需求 |
|---------|------|---------|
| 初级健身者 | 训练 0–1 年，动作库有限 | 规范记录、学习动作、获得训练指导 |
| 中级健身者 | 训练 1–3 年，有明确目标 | 突破平台期、周期化训练、容量管理 |
| 高级健身者 | 训练 3 年以上，数据驱动型 | 精细化分析、生理数据整合、自适应调整 |

### 1.3 技术选型总览

| 层级 | 技术栈 | 选型理由 |
|------|--------|---------|
| 前端 | React + TypeScript + PWA | 跨平台、离线可用、安装体验接近原生 |
| UI 框架 | Tailwind CSS + shadcn/ui | 高效开发、风格统一、组件丰富 |
| 图表库 | Recharts / D3.js | 1RM 趋势、容量热力图等数据可视化 |
| 后端 | Python FastAPI | 异步高性能、类型安全、ML 生态完善 |
| 数据库 | PostgreSQL（主库）+ Redis（缓存） | 结构化数据 + 高速缓存 |
| 时序数据 | TimescaleDB（PostgreSQL 扩展） | 心率、HRV 等高频生理数据存储 |
| 认证 | JWT + OAuth 2.0 | 支持邮箱注册 + 第三方登录 |
| 部署 | Docker + Nginx | 容器化部署，便于扩展 |

---

## 二、功能模块详细设计

### 2.1 模块一：训练记录（基础层）

#### 功能描述

用户记录每次训练的完整数据，作为整个系统的数据基石。

#### 核心数据维度

| 字段 | 类型 | 说明 | 必填 |
|------|------|------|------|
| exercise | 引用 | 关联动作库 | ✅ |
| weight | float | 训练重量（kg/lb） | ✅ |
| reps | int | 每组次数 | ✅ |
| sets | int | 组数 | ✅ |
| rpe | int (1–10) | 主观疲劳度评分 | ⭐推荐 |
| rest_seconds | int | 组间休息秒数 | 可选 |
| tempo | string | 离心/等长/向心节奏（如"3-1-2"） | 可选 |
| notes | text | 体感备注（关节不适、状态好等） | 可选 |

#### 交互设计要点

- **快捷录入**：支持从"上次训练"一键复制，修改差异即可
- **训练模板**：用户可保存常用训练日为模板（如"胸+三头日"）
- **实时计时器**：内置组间休息倒计时，自动记录休息时长
- **离线优先**：PWA 本地缓存 → 联网后同步，健身房信号差也能用

#### 动作库设计

系统预置 200+ 常见动作，用户可自定义新增：

```
动作分类结构:
├── 胸部 (Chest)
│   ├── 复合动作: 平板杠铃卧推, 上斜哑铃卧推, 双杠臂屈伸...
│   └── 孤立动作: 龙门架夹胸, 蝴蝶机夹胸...
├── 背部 (Back)
│   ├── 复合动作: 硬拉, 杠铃划船, 引体向上...
│   └── 孤立动作: 直臂下压, 绳索面拉...
├── 腿部 (Legs)
│   ├── 股四头: 深蹲, 腿举, 腿屈伸...
│   ├── 股二头: 罗马尼亚硬拉, 腿弯举...
│   └── 臀部: 臀推, 保加利亚分腿蹲...
├── 肩部 (Shoulders)
├── 手臂 (Arms)
└── 核心 (Core)
```

每个动作包含属性：主要肌群、辅助肌群、动作类型（复合/孤立）、所需器械、难度等级。

---

### 2.2 模块二：数据分析与 1RM 推算（分析层）

#### 1RM 推算引擎

采用**多公式加权 + RPE 修正**策略，比单一公式更准确：

**Step 1 — RPE 修正实际次数**

```
RPE 映射表:
RPE 10 → 还能做 0 次 (力竭)
RPE 9  → 还能做 1 次
RPE 8  → 还能做 2 次
RPE 7  → 还能做 3 次
RPE 6  → 还能做 4 次

有效次数 = 实际次数 + (10 - RPE)
示例: 100kg × 5reps @ RPE 8 → 有效次数 = 5 + 2 = 7
```

**Step 2 — 多公式计算**

| 公式 | 计算方式 | 适用范围 | 权重 |
|------|---------|---------|------|
| Epley | weight × (1 + reps / 30) | 中等次数 (5–10) | 0.35 |
| Brzycki | weight × 36 / (37 - reps) | 低次数 (1–6) | 0.35 |
| Lombardi | weight × reps^0.10 | 高次数 (10+) | 0.15 |
| O'Conner | weight × (1 + 0.025 × reps) | 通用 | 0.15 |

**Step 3 — 加权平均**

根据实际训练次数范围动态调整各公式权重，输出最终 estimated 1RM。

#### 数据可视化看板

| 图表类型 | 展示内容 | 用途 |
|---------|---------|------|
| 折线图 | 各动作 1RM 随时间变化趋势 | 判断进步速度、识别平台期 |
| 柱状图 | 每周/月各肌群训练总容量 | 确认容量分布是否均衡 |
| 热力图 | 肌群训练频率日历 | 直观发现训练遗漏 |
| 雷达图 | 全身各部位力量水平对比 | 识别弱项，指导补强 |

#### 进阶分析指标

- **E1RM 趋势斜率**：正斜率 = 持续进步，趋平 = 平台期，需调整训练策略
- **容量负荷 (Volume Load)**：总重量 × 总次数，衡量训练密度
- **频率建议**：统计各肌群周训练频率，低于推荐值时提醒

---

### 2.3 模块三：智能训练计划生成（智能层）

#### 用户输入参数

```
用户交互界面收集:
├── 训练目标: 力量 / 肌肥大 / 耐力 / 综合
├── 训练部位: 全身 / 上肢 / 下肢 / 推 / 拉 / 腿 / 自定义
├── 可用时间: 30min / 45min / 60min / 90min
├── 训练频率: 每周 3–6 次
├── 可用器械: 全器械 / 仅哑铃 / 居家徒手 / 自定义
└── 经验等级: 初级 / 中级 / 高级 (影响动作选择和容量)
```

#### 计划生成规则引擎

**强度区间映射（基于 1RM 百分比）**

| 训练目标 | 强度范围 (%1RM) | 每组次数 | 组数 | 组间休息 |
|---------|----------------|---------|------|---------|
| 绝对力量 | 85–95% | 1–5 | 4–6 | 3–5 min |
| 力量+肌肥大 | 75–85% | 5–8 | 3–5 | 2–3 min |
| 肌肥大 (容量) | 65–80% | 8–12 | 3–4 | 60–90 sec |
| 肌耐力 | 50–65% | 12–20+ | 2–3 | 30–60 sec |

**周期化策略**

系统支持三种主流周期化模型：

```
1. 线性周期 (Linear Periodization)
   适合: 初级/中级用户
   逻辑: 每周渐进增加强度，降低容量
   示例:
   Week 1: 70% × 10 reps × 4 sets
   Week 2: 75% × 8 reps × 4 sets
   Week 3: 80% × 6 reps × 4 sets
   Week 4: 60% × 8 reps × 3 sets (减载周)

2. 波动周期 (Daily Undulating Periodization, DUP)
   适合: 中级/高级用户
   逻辑: 同一周内交替不同强度
   示例:
   Mon (力量日): 85% × 4 reps × 5 sets
   Wed (容量日): 70% × 10 reps × 4 sets
   Fri (速度日): 60% × 6 reps × 5 sets (爆发力)

3. 块状周期 (Block Periodization)
   适合: 高级用户 / 备赛
   逻辑: 每个 3–4 周 block 专注一个目标
   Block 1 (积累): 高容量、中等强度
   Block 2 (转化): 中等容量、高强度
   Block 3 (实现): 低容量、极高强度 → 测试新 1RM
```

**疲劳管理模块**

| 肌群 | 推荐周最大有效组数 (MEV–MRV) | 恢复周期 |
|------|---------------------------|---------|
| 胸部 | 12–20 组 | 48–72 小时 |
| 背部 | 14–22 组 | 48–72 小时 |
| 股四头肌 | 12–18 组 | 72–96 小时 |
| 肩部 | 12–18 组 | 48 小时 |
| 手臂 | 10–16 组 | 48 小时 |

系统自动追踪各肌群周训练总组数，接近 MRV（最大可恢复容量）上限时发出减量提醒。

#### 计划输出示例

```
═══════════════════════════════════════════
  🏋️ 今日训练: 胸部 + 三头肌 (力量+肌肥大)
  ⏱️ 预计时间: 55 分钟
═══════════════════════════════════════════

  1. 平板杠铃卧推 (主项 - 力量)
     → 80kg × 5 reps × 4 sets | RPE 目标 8 | 休息 3 min

  2. 上斜哑铃卧推 (辅助 - 肌肥大)
     → 28kg × 8 reps × 3 sets | RPE 目标 7–8 | 休息 90 sec

  3. 龙门架夹胸 (孤立 - 容量)
     → 15kg × 12 reps × 3 sets | RPE 目标 7 | 休息 60 sec

  4. 绳索下压 (三头 - 肌肥大)
     → 25kg × 10 reps × 3 sets | RPE 目标 8 | 休息 60 sec

  5. 仰卧臂屈伸 (三头 - 容量)
     → 20kg × 12 reps × 3 sets | RPE 目标 7 | 休息 60 sec

═══════════════════════════════════════════
```

---

### 2.4 模块四：生理数据整合与自适应（高级层）

#### 数据源接入

| 数据源 | 接入方式 | 可获取指标 |
|--------|---------|-----------|
| Apple Health | HealthKit API (iOS) | 心率、HRV、血氧、睡眠、步数 |
| Google Fit | REST API | 心率、活动数据、睡眠 |
| Garmin Connect | Garmin API | 全面生理指标、Body Battery |
| Whoop | Whoop API | HRV、恢复分数、应变 |
| 小米手环/华为手表 | 各厂商 API | 心率、血氧、睡眠 |
| 手动输入 | 应用内表单 | 血压、体温等不常自动采集的数据 |

#### 恢复评估模型

**综合恢复指数 (Recovery Index, 0–100)**

```
恢复指数计算:
├── HRV 评分 (权重 35%)
│   基线 HRV ± 偏差 → 归一化到 0–100
│   高于基线 = 恢复良好, 低于基线 = 疲劳
│
├── 睡眠评分 (权重 25%)
│   时长 + 深睡比例 + 入睡效率 → 0–100
│
├── 静息心率评分 (权重 20%)
│   与个人基线对比，偏高 = 疲劳信号
│
├── 主观疲劳评分 (权重 10%)
│   用户每日自评 1–10 → 归一化
│
└── 训练负荷评分 (权重 10%)
    近 48h 训练量 vs 周平均 → 判断是否需要恢复

→ 最终恢复指数 = 加权求和
```

#### 自适应调整策略

| 恢复指数 | 状态 | 自适应调整 |
|---------|------|-----------|
| 80–100 | 🟢 充分恢复 | 按计划执行，可尝试突破 |
| 60–79 | 🟡 基本恢复 | 按计划执行，不追加容量 |
| 40–59 | 🟠 疲劳 | 强度降低 10–15%，减少 1–2 组 |
| 20–39 | 🔴 显著疲劳 | 切换为轻量恢复训练或拉伸 |
| 0–19 | ⚫ 需要休息 | 建议完全休息，推送恢复建议 |

**训练中实时调整（可穿戴设备实时连接时）**

- 心率持续高于有氧阈值 → 自动延长组间休息建议
- 单组后心率恢复速度变慢 → 提示降低后续组重量
- 血氧下降明显 → 提醒注意呼吸节奏

---

## 三、系统架构设计

### 3.1 整体架构图

```
┌──────────────────────────────────────────────────────────────┐
│                        客户端层                               │
│  ┌─────────────────────────────────────────────────────┐     │
│  │              React PWA + TypeScript                  │     │
│  │  ┌──────────┐ ┌──────────┐ ┌────────┐ ┌─────────┐  │     │
│  │  │训练记录   │ │数据看板   │ │计划中心 │ │健康监控  │  │     │
│  │  │模块      │ │模块      │ │模块    │ │模块     │  │     │
│  │  └──────────┘ └──────────┘ └────────┘ └─────────┘  │     │
│  │  ┌──────────────────────────────────────────────┐   │     │
│  │  │     本地缓存层 (IndexedDB + Service Worker)   │   │     │
│  │  └──────────────────────────────────────────────┘   │     │
│  └─────────────────────────────────────────────────────┘     │
└──────────────────────────┬───────────────────────────────────┘
                           │ HTTPS / WebSocket
┌──────────────────────────▼───────────────────────────────────┐
│                      API 网关层 (Nginx)                       │
│              SSL 终止 | 负载均衡 | 限流 | CORS                │
└──────────────────────────┬───────────────────────────────────┘
                           │
┌──────────────────────────▼───────────────────────────────────┐
│                    应用服务层 (FastAPI)                        │
│  ┌───────────┐ ┌───────────┐ ┌────────────┐ ┌────────────┐  │
│  │ 训练服务   │ │ 分析服务   │ │ 计划服务    │ │ 健康服务    │ │
│  │ record_svc│ │ analyze_svc│ │ plan_svc   │ │ health_svc │ │
│  │           │ │            │ │            │ │            │  │
│  │ - CRUD    │ │ - 1RM 计算 │ │ - 规则引擎  │ │ - 数据接入  │ │
│  │ - 模板    │ │ - 趋势分析 │ │ - 周期编排  │ │ - 恢复评估  │ │
│  │ - 动作库  │ │ - 容量统计 │ │ - 疲劳管理  │ │ - 实时调整  │ │
│  └─────┬─────┘ └─────┬─────┘ └──────┬─────┘ └──────┬─────┘ │
│        │             │              │               │        │
│  ┌─────▼─────────────▼──────────────▼───────────────▼─────┐ │
│  │                  共享基础设施                             │ │
│  │  认证中间件 | 日志 | 错误处理 | 数据验证 (Pydantic)      │ │
│  └────────────────────────────────────────────────────────┘ │
└──────────────────────────┬───────────────────────────────────┘
                           │
┌──────────────────────────▼───────────────────────────────────┐
│                        数据层                                 │
│  ┌──────────────┐  ┌──────────┐  ┌────────────────────────┐ │
│  │ PostgreSQL   │  │  Redis   │  │ TimescaleDB (扩展)      │ │
│  │ 用户/训练/   │  │ 会话缓存  │  │ 心率/HRV/血氧          │ │
│  │ 动作/计划    │  │ 限流计数  │  │ 时序数据高效查询        │ │
│  └──────────────┘  └──────────┘  └────────────────────────┘ │
└──────────────────────────────────────────────────────────────┘
                           │
┌──────────────────────────▼───────────────────────────────────┐
│                    外部服务接入层                              │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐               │
│  │Apple Health │ │ Google Fit │ │ Garmin API │  ...          │
│  └────────────┘ └────────────┘ └────────────┘               │
└──────────────────────────────────────────────────────────────┘
```

### 3.2 核心数据模型 (ER 结构)

```
┌──────────────┐       ┌──────────────────────┐
│    User      │       │     Exercise         │
├──────────────┤       ├──────────────────────┤
│ id (PK)      │       │ id (PK)              │
│ email        │       │ name                 │
│ nickname     │       │ name_en              │
│ body_weight  │       │ primary_muscle       │
│ height       │       │ secondary_muscles[]  │
│ training_age │       │ category             │
│ unit_pref    │       │ equipment            │
│ created_at   │       │ difficulty           │
└──────┬───────┘       │ is_custom            │
       │               └──────────┬───────────┘
       │                          │
       │    ┌─────────────────────┼──────────────────┐
       │    │                     │                   │
       ▼    ▼                     ▼                   │
┌──────────────────┐   ┌──────────────────┐           │
│ WorkoutSession   │   │  WorkoutSet      │           │
├──────────────────┤   ├──────────────────┤           │
│ id (PK)          │   │ id (PK)          │           │
│ user_id (FK)     │──▶│ session_id (FK)  │           │
│ date             │   │ exercise_id (FK) │◀──────────┘
│ duration_min     │   │ set_order        │
│ body_weight      │   │ weight           │
│ overall_rpe      │   │ reps             │
│ notes            │   │ rpe              │
│ template_name    │   │ rest_seconds     │
└──────────────────┘   │ tempo            │
       │               └──────────────────┘
       │
       ▼
┌──────────────────┐   ┌──────────────────┐
│ Estimated1RM     │   │  TrainingPlan    │
├──────────────────┤   ├──────────────────┤
│ id (PK)          │   │ id (PK)          │
│ user_id (FK)     │   │ user_id (FK)     │
│ exercise_id (FK) │   │ name             │
│ date             │   │ goal             │
│ estimated_1rm    │   │ periodization    │
│ method           │   │ frequency        │
│ confidence       │   │ start_date       │
└──────────────────┘   │ end_date         │
                       │ plan_json        │
       ┌───────────────┴──────────────────┘
       │
       ▼
┌──────────────────┐
│  HealthMetric    │
├──────────────────┤
│ id (PK)          │
│ user_id (FK)     │
│ timestamp        │
│ metric_type      │
│ value            │
│ source           │
└──────────────────┘
```

---

## 四、API 设计概览

### 4.1 RESTful API 路由

```
认证模块:
  POST   /api/auth/register          注册
  POST   /api/auth/login             登录
  POST   /api/auth/refresh           刷新 Token

训练记录模块:
  GET    /api/workouts                获取训练记录列表 (?page, ?date_range)
  POST   /api/workouts                创建训练记录
  GET    /api/workouts/{id}           获取单次训练详情
  PUT    /api/workouts/{id}           更新训练记录
  DELETE /api/workouts/{id}           删除训练记录
  POST   /api/workouts/from-template  从模板创建训练

动作库模块:
  GET    /api/exercises               获取动作列表 (?muscle_group, ?category)
  POST   /api/exercises               创建自定义动作
  GET    /api/exercises/{id}          动作详情

分析模块:
  GET    /api/analysis/1rm/{exercise_id}       获取指定动作 1RM 趋势
  GET    /api/analysis/volume?period=week      获取容量统计
  GET    /api/analysis/muscle-balance          获取肌群平衡分析
  GET    /api/analysis/progress-report         获取综合进步报告

计划模块:
  POST   /api/plans/generate          根据参数生成训练计划
  GET    /api/plans                    获取已保存计划列表
  GET    /api/plans/{id}               获取计划详情
  PUT    /api/plans/{id}               修改计划
  GET    /api/plans/{id}/today         获取今日训练安排
  POST   /api/plans/{id}/adapt        请求自适应调整 (传入健康数据)

健康数据模块:
  POST   /api/health/sync             同步外部健康数据
  GET    /api/health/metrics           获取健康指标 (?type, ?date_range)
  GET    /api/health/recovery-index    获取当前恢复指数
  POST   /api/health/manual            手动录入健康数据
```

### 4.2 WebSocket 端点（实时功能）

```
  WS  /ws/workout-timer              训练中实时计时器同步
  WS  /ws/heart-rate-stream          实时心率流 (连接可穿戴设备时)
```

---

## 五、开发路线图

### Phase 1 — MVP 最小可用产品（约 6–8 周）

```
目标: 能用的训练记录 + 基础分析工具

Week 1–2: 基础设施搭建
  ├── 项目脚手架 (前端 React + 后端 FastAPI)
  ├── 数据库建模 & 迁移 (Alembic)
  ├── 用户认证 (注册/登录/JWT)
  └── CI/CD 管道 (GitHub Actions + Docker)

Week 3–4: 训练记录核心
  ├── 动作库 (预置数据 seed)
  ├── 训练记录 CRUD (含 UI 表单)
  ├── 训练历史列表 & 日历视图
  └── 训练模板保存/加载

Week 5–6: 基础分析
  ├── 1RM 推算引擎 (多公式加权)
  ├── 1RM 趋势折线图
  ├── 周容量统计柱状图
  └── 肌群训练频率热力图

Week 7–8: PWA & 打磨
  ├── Service Worker 离线缓存
  ├── 响应式适配 (手机优先)
  ├── 组间休息计时器
  └── 数据导出 (CSV)
```

**Phase 1 交付物**: 可部署的 PWA，支持训练记录、1RM 追踪、基础数据可视化。

---

### Phase 2 — 智能计划引擎（约 4–6 周）

```
目标: 根据用户数据自动生成个性化训练计划

Week 9–10: 计划生成基础
  ├── 用户输入交互界面 (目标/部位/时间/器械)
  ├── 强度区间映射规则
  ├── 单次训练计划生成 (基于规则引擎)
  └── 计划展示 & 执行界面

Week 11–12: 周期化 & 疲劳管理
  ├── 线性周期 & DUP 周计划生成
  ├── 疲劳累积追踪 (各肌群周组数)
  ├── 减载周自动编排
  └── 计划日历视图

Week 13–14: 智能优化
  ├── 基于历史数据的个性化推荐 (常用动作偏好、恢复速度)
  ├── 平台期检测 & 策略建议
  ├── RPE 趋势分析 (判断是否低估/高估能力)
  └── 计划完成度追踪
```

**Phase 2 交付物**: 完整的规则驱动计划生成系统，支持多种周期化策略。

---

### Phase 3 — 生理数据整合（约 4–6 周）

```
目标: 接入健康数据，实现自适应训练调整

Week 15–16: 数据接入
  ├── Apple Health / Google Fit OAuth 接入
  ├── 健康数据同步服务
  ├── TimescaleDB 时序存储
  └── 健康数据看板 (心率/HRV/睡眠趋势)

Week 17–18: 恢复评估
  ├── 恢复指数计算模型
  ├── 每日恢复状态推送
  ├── 训练前恢复检查提示
  └── 自适应调整策略实现

Week 19–20: 实时功能
  ├── 训练中心率实时监控 (WebSocket)
  ├── 动态组间休息建议
  ├── 异常数据告警 (心率异常高等)
  └── 训练后恢复追踪
```

**Phase 3 交付物**: 生理数据驱动的自适应训练系统。

---

### Phase 4 — 增强功能（持续迭代）

```
可选方向:
  ├── AI 增强: 接入 LLM (如 Claude API) 提供自然语言训练咨询
  ├── 社交功能: 训练打卡分享、好友排行榜
  ├── 营养模块: 基于训练量估算热量消耗、蛋白质建议
  ├── 视频指导: 动作库配套教学视频 / 动作纠正提示
  ├── 多语言支持: 中文 / 英文 / 日文等
  └── 数据报告: 生成月度/季度训练 PDF 报告
```

---

## 六、项目目录结构建议

```
fittracker/
├── frontend/                       # 前端项目
│   ├── public/
│   │   └── manifest.json           # PWA 配置
│   ├── src/
│   │   ├── components/             # 通用组件
│   │   │   ├── ui/                 # shadcn/ui 组件
│   │   │   ├── Timer.tsx           # 组间休息计时器
│   │   │   └── ExercisePicker.tsx  # 动作选择器
│   │   ├── pages/                  # 页面
│   │   │   ├── Dashboard.tsx       # 首页看板
│   │   │   ├── WorkoutLog.tsx      # 训练记录
│   │   │   ├── Analytics.tsx       # 数据分析
│   │   │   ├── PlanCenter.tsx      # 计划中心
│   │   │   └── HealthMonitor.tsx   # 健康监控
│   │   ├── hooks/                  # 自定义 hooks
│   │   ├── stores/                 # 状态管理 (Zustand)
│   │   ├── services/               # API 调用封装
│   │   ├── utils/                  # 工具函数
│   │   └── types/                  # TypeScript 类型定义
│   └── package.json
│
├── backend/                        # 后端项目
│   ├── app/
│   │   ├── main.py                 # FastAPI 入口
│   │   ├── config.py               # 配置管理
│   │   ├── models/                 # SQLAlchemy 数据模型
│   │   │   ├── user.py
│   │   │   ├── exercise.py
│   │   │   ├── workout.py
│   │   │   ├── plan.py
│   │   │   └── health.py
│   │   ├── schemas/                # Pydantic 请求/响应模型
│   │   ├── routers/                # API 路由
│   │   │   ├── auth.py
│   │   │   ├── workouts.py
│   │   │   ├── exercises.py
│   │   │   ├── analysis.py
│   │   │   ├── plans.py
│   │   │   └── health.py
│   │   ├── services/               # 业务逻辑
│   │   │   ├── rm_calculator.py    # 1RM 推算引擎
│   │   │   ├── plan_generator.py   # 计划生成引擎
│   │   │   ├── recovery_model.py   # 恢复评估模型
│   │   │   └── health_sync.py      # 健康数据同步
│   │   ├── middleware/             # 中间件 (认证/日志/限流)
│   │   └── utils/                  # 工具函数
│   ├── migrations/                 # Alembic 数据库迁移
│   ├── tests/                      # 测试
│   ├── seeds/                      # 初始数据 (动作库等)
│   └── requirements.txt
│
├── docker-compose.yml              # 本地开发环境编排
├── Dockerfile.frontend
├── Dockerfile.backend
├── nginx.conf                      # Nginx 反向代理配置
└── README.md
```

---

## 七、关键技术决策与注意事项

### 7.1 为什么选择 PWA 而非原生 App？

开发一套代码即可覆盖 iOS、Android 和桌面端，大幅降低开发成本。PWA 的 Service Worker 支持离线使用（健身房信号差的核心场景），安装后体验接近原生 App。如果后续需要深度系统集成（如 HealthKit 后台同步），可以用 Capacitor 打包成原生壳。

### 7.2 1RM 推算的精度保障

单一公式在极端次数范围（如 1–2 reps 或 15+ reps）误差较大，因此采用多公式加权方案。RPE 修正是关键差异化能力——大多数竞品 App 不做 RPE 修正，导致推算结果偏低。建议收集用户实际测试 1RM 的数据，后续可训练个性化校准模型。

### 7.3 计划生成的扩展性

Phase 2 先用规则引擎（if-else + 配置表）实现计划生成，这已经能覆盖 90% 的需求。Phase 4 可以引入 LLM（如 Claude API）作为"智能教练"，处理更复杂的自然语言交互场景，如"我膝盖最近有点不舒服，帮我调整一下腿部训练"。

### 7.4 数据隐私与安全

健康数据属于敏感个人信息，必须加密存储、传输全程 HTTPS、OAuth Token 安全管理。建议提供本地存储模式（数据仅存手机端），让对隐私敏感的用户可选。

### 7.5 性能优化策略

- **前端**：训练记录页虚拟列表（大量历史数据时）、图表懒加载
- **后端**：1RM 计算结果缓存（Redis，数据变动时失效）、分页查询
- **数据库**：训练记录表按日期分区、健康数据时序索引

---

## 八、成本估算（个人/小团队）

| 项目 | 方案 | 月成本估算 |
|------|------|-----------|
| 服务器 | 轻量云服务器 2C4G | ¥50–100/月 |
| 数据库 | 同机部署 PostgreSQL | ¥0（包含在服务器） |
| 域名 + SSL | Let's Encrypt 免费证书 | ¥50/年 |
| CDN | Cloudflare 免费版 | ¥0 |
| 总计 | | 约 ¥100/月起步 |

> 前期用户量小的情况下，一台轻量云服务器即可承载全部服务。

---

*本方案为初版设计，具体实现过程中可根据实际情况调整优先级和技术细节。*
